(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(23),i=n.n(r),o=(n(79),n(70)),l=n(22),s=n(21),u=n(69),m=n(24),d=n(71),b=n(38),f=n(51),h=(n(80),n(30)),O=n(9),p=n(33),j=n(72),E=n(6),g=n(64),v=n(34),y=n.n(v),k=n(41),_=n(73),w=n(50),H=n(31),P=n(35),x=n(65),N={links:[],entities:[],status:{}},G=Object(a.createContext)({state:N,dispatch:function(e){console.log("not la bonne fonction poto",e)}}),M=Object(k.a)(function(e){return e.GPH_code}),C=function(e,t){var n=new x.MultiMap;for(var a in e)if(e.hasOwnProperty(a)){var c=e[a],r=t[a];if(void 0===r)continue;for(var i=0;i<c.length;i++){var o=c[i];n.set(r,o)}}return n},L=function(e,t){switch(t.type){case"LOADED":var n=t.payload[0],a=t.payload[1],c=n.map(function(e){var t={id:y()(),GPH_code:e.GPH_code,GPH_name:e.GPH_name,end_year:new Date(e.end_year),start_year:new Date(e.start_year),status:a[e.GPH_status],sovereign:{GPH_code:e.sovereign_GPH_code,GPH_name:e.sovereign_GPH_name}};return t.status||console.error("unknown link type",e),t}),r=M(c),i=Object(P.a)(function(e,t){var n=Object(H.a)(Object(w.a)(function(e){return Object(p.a)(e.GPH_code,t)}),Object(k.a)(function(e){return e.sovereign.GPH_code||t})),a=Object(H.a)(Object(w.a)(function(e){return Object(p.a)(e.sovereign.GPH_code,t)}),M),i=n(e),o=a(c),l=Object(k.a)(function(e){return e.status.slug},Object(_.a)(Object(E.k)(o)));return{id:t,name:r[t][0].GPH_name,start:Object(E.e)(e,function(e){return e.start_year}),end:Object(E.d)(e,function(e){return e.end_year}),occupations:i,campains:o,campainsMap:l}},r),l=Object(o.a)(function(e){return Object(j.a)({},e,{occupations:C(e.occupations,i),campains:C(e.campains,i)})},i);return c.forEach(function(e){e.sovereign=l[e.sovereign.GPH_code]}),{links:c,entities:Object(E.k)(l),status:a}}return e},S=function(e){return Object(g.action)("LOADED",e)},W=Object(E.c)("./data/GeoPolHist_entities_status_in_time.csv"),D=fetch("./data/GPH_status.json").then(function(e){return e.json()}),z=Promise.all([W,D]),A=function(e){var t=Object(a.useReducer)(L,N),n=Object(O.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)(function(){z.then(Object(H.a)(S,i))},[]),c.a.createElement(G.Provider,{value:{state:r,dispatch:i}},e.children)},T=n(36),B=n(66),J=n(42),U=n.n(J),I=function(e,t){return"translate(".concat(e,", ").concat(t,")")},R=(n(111),50),Y=0,$=0,q=50,F=0,K=Object(E.j)("%Y"),Q=Object(H.a)(Object(T.a)(function(e,t){var n=Object(O.a)(t,2)[1];return[].concat(Object(h.a)(e),Object(h.a)(n))},[]),Object(B.a)(function(e){return e.status.slug})),V=function(e){var t=Object(a.useContext)(G).state,n=Object(E.g)(["#cd7f3d","#af49d8","#65da57","#d84397","#cbe240","#6c6cd4","#a3ca63","#ad63ab","#489046","#d74433","#6cdaaf","#c15b67","#86c5d8","#d8b94f","#6779a8","#787938","#d4a8cc","#4f8178","#cdcea7","#997462"]).domain(Object.keys(t.status).map(function(e){return t.status[e].slug})),r=e.xScale,i=e.data,o=e.nbLines,l=Object(a.useMemo)(y.a,[]),s=e.width-F-$,u=o*e.lineHeight+Y+q,m=u-Y-q,d=e.hideGroupLabels?0:200,f=m/i.length,h=function(t){return Math.max(e.intervalMinWidth,r(t.end_year)-r(t.start_year))};r.range([d,s]);var p=Object(E.f)().domain([0,o]).range([0,m]),j=Object(E.b)(r),g=Object(E.a)(r),v=.8*f,k=(f-v)/2,_=Object(a.useState)(),w=Object(O.a)(_,2),H=w[0],x=w[1],N=Object(a.useState)(),M=Object(O.a)(N,2),C=M[0],L=M[1],S=Object(a.useMemo)(function(){return Q(i)},[i]);return Object(a.useEffect)(function(){return function(){x(null),L(null)}},[e.data]),c.a.createElement("div",{className:"timelines-container",style:{width:s},onMouseLeave:function(){return x(null)}},H&&c.a.createElement("div",{className:"tooltip-container",style:{transform:"translate(".concat(r(H.link.start_year),"px, ").concat(p(H.index)+R+Y+e.lineHeight+20,"px)"),minWidth:h(H.link)}},c.a.createElement("span",{className:"tooltip"},H.link.GPH_name," was a ",H.link.status.slug," from ",K(H.link.start_year)," to ",K(H.link.end_year))),c.a.createElement("div",{className:"legend"},c.a.createElement("div",{className:"legend-container"},Object(b.a)(Object(P.a)(function(e,t){return c.a.createElement("button",{onClick:function(){return L(C===t?null:t)},className:U()({"legend-item":!0,"legend-item--hidden":C&&C!==t}),key:t,style:{backgroundColor:n(t)}},t," : ",e)},S))),c.a.createElement("svg",{height:20,width:e.width},c.a.createElement("g",{transform:I(F,Y)},c.a.createElement("g",{transform:I(0,17),ref:function(e){e&&Object(E.i)(e).call(j)}})))),c.a.createElement("svg",{height:u,width:e.width},c.a.createElement("g",{transform:I(F,Y)},c.a.createElement("defs",null,c.a.createElement("pattern",{id:"diagonalHatch-".concat(l),patternUnits:"userSpaceOnUse",width:"4",height:"4"},c.a.createElement("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"black",strokeWidth:1}})),c.a.createElement("clipPath",{id:"name-area-".concat(l)},c.a.createElement("rect",{x:0,y:0,height:m,width:d}))),c.a.createElement("g",{transform:I(0,m),ref:function(e){e&&Object(E.i)(e).call(g)}}),c.a.createElement("g",{className:U()({group:!0,has_status:!!C},C)},i.map(function(t,a){var i=Object(O.a)(t,2),o=i[0],u=i[1];return c.a.createElement("g",{key:o.name,className:o.name,transform:I(0,p(a))},c.a.createElement("line",{className:"group-separator",x1:0,x2:s,y1:0,y2:0,stroke:"black",strokeOpacity:.1}),c.a.createElement("text",{className:"entity-label",style:{clipPath:"url(#name-area-".concat(l,")")},fontSize:e.lineHeight,dy:"1em"},o.name),c.a.createElement("g",null,u.map(function(t){var i=h(t);return c.a.createElement("g",{key:t.id,transform:I(r(t.start_year),k)},c.a.createElement("rect",{rx:"5",className:U()("link-rect",t.status.slug),onClick:function(){return e.onLinkClick(t)},onMouseEnter:function(){return x({link:t,index:a})},fill:isNaN(i)?"url(#diagonalHatch-".concat(l,")"):n(t.status.slug),stroke:H&&H.link===t?"white":"black",strokeOpacity:H&&H.link===t?1:.2,strokeWidth:H&&H.link===t?2:1,width:isNaN(i)?"100%":i,height:v,y:0,x:0}))})))})))))},X=function(e,t){return e+ +t.end_year-+t.start_year},Z=Object(m.a)(function(e,t){var n=Object(O.a)(e,2)[1];return Object(O.a)(t,2)[1].reduce(X,0)-n.reduce(X,0)}),ee=function(e){var t=e.history,n=e.country,r=Object(a.useCallback)(function(e){t.push("/country/".concat(e.sovereign.id))},[t]),i=Object(a.useCallback)(function(e){t.push("/country/".concat(e.GPH_code))},[t]),o=Array.from(n.occupations.associations()),s=Array.from(n.campains.associations()),u=Object(a.useMemo)(function(){return Z([].concat(Object(h.a)(o),Object(h.a)(s)))},[o,s]),m=Object(E.e)(u,function(e){return Object(O.a)(e,1)[0].start}),d=Object(E.d)(u,function(e){return Object(O.a)(e,1)[0].end}),b=Object(E.h)().domain([m,d]);return c.a.createElement("div",null,c.a.createElement("aside",null,c.a.createElement(l.b,{to:"/"},"Home")),c.a.createElement("h1",null,n.name," (",n.id,")"),c.a.createElement("h2",null,"Status"),c.a.createElement(V,{onLinkClick:r,intervalMinWidth:5,data:o,nbLines:n.occupations.dimension,lineHeight:20,width:1e3,xScale:b}),c.a.createElement("h2",null,"Sovereign of"),c.a.createElement(V,{onLinkClick:i,intervalMinWidth:5,data:s,nbLines:n.campains.dimension,lineHeight:20,width:1e3,xScale:b}))},te=function(e){var t=e.match.params.id,n=Object(a.useContext)(G).state.entities.find(function(e){return Object(p.a)(e.id,t)});return void 0===n?c.a.createElement("div",null,"Loading"):c.a.createElement(ee,Object.assign({},e,{country:n}))},ne=Object(o.a)(function(e){return{value:e.id,label:e.name}}),ae=Object(m.a)(function(e,t){return t.campains.size-e.campains.size}),ce=Object(m.a)(function(e,t){return t.occupations.size-e.occupations.size}),re=Object(f.a)(0,["campainsMap","col","length"]),ie=Object(m.a)(function(e,t){return re(t)-re(e)}),oe=Object(d.a)(5),le=function(e){var t=oe(ae(e.entities)),n=oe(ce(e.entities)),r=oe(ie(e.entities)),i=Object(a.useContext)(G).state;return c.a.createElement("div",null,c.a.createElement("h2",null,"Some examples:"),c.a.createElement("div",{className:"line"},c.a.createElement("div",{className:"grow"},c.a.createElement("h3",null,"Most aggresive empires:"),c.a.createElement("ol",null,t.map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(l.b,{to:"/country/".concat(e.id)},e.name))}))),c.a.createElement("div",{className:"grow"},c.a.createElement("h3",null,"Occupied by most different countries:"),c.a.createElement("ol",null,n.map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(l.b,{to:"/country/".concat(e.id)},e.name))}))),c.a.createElement("div",{className:"grow"},c.a.createElement("h3",null,"Most colonies:"),c.a.createElement("ol",null,r.map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(l.b,{to:"/country/".concat(e.id)},e.name))})))),c.a.createElement("h3",null,"Countries by status"),c.a.createElement("div",{className:"line"},Object(b.a)(i.status).map(function(t){var n=Object(f.a)(0,["campainsMap",t.slug,"length"]),a=Object(m.a)(function(e,t){return n(t)-n(e)});return c.a.createElement("div",{key:t.slug,className:"grow"},c.a.createElement("h3",null,"counties with most ",t.GPH_status,":"),c.a.createElement("ol",null,oe(a(e.entities)).map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(l.b,{to:"/country/".concat(e.id)},e.name))})))})))},se=function(e){var t=Object(a.useContext)(G).state,n=Object(a.useCallback)(function(t){e.history.push("/country/".concat(t.value))},[e.history]);return c.a.createElement("div",{className:"container container--home"},c.a.createElement("h1",null,"Welcome"),c.a.createElement("h3",null,"To the correlates of war time series explorer"),c.a.createElement("p",null,"Type a country or a territorial name in the above text input :"),c.a.createElement(u.a,{placeholder:t.entities.length?"Type in":"Still loading",onChange:n,options:ne(t.entities)}),t.entities.length?c.a.createElement(le,{entities:t.entities}):c.a.createElement("p",null,"Data is still loading..."))},ue=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(A,null,c.a.createElement(l.a,{basename:"/GeoPolHist"},c.a.createElement(s.a,{path:"/",exact:!0,component:se}),c.a.createElement(s.a,{path:"/country/:id",component:te}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},74:function(e,t,n){e.exports=n(118)},79:function(e,t,n){},80:function(e,t,n){}},[[74,1,2]]]);
//# sourceMappingURL=main.6b4a7ec9.chunk.js.map