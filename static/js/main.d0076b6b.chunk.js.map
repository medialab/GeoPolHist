{"version":3,"sources":["utils.ts","serviceWorker.ts","index.tsx","AppContext.tsx","App.tsx","timeline.tsx","Country.tsx"],"names":["__webpack_require__","d","__webpack_exports__","translate_link_type","translate","STATUS_SLUG","Became part of","slug","priority","Became colony of","Became possession of","Claimed by","Became protectorate of","Became associated state of","Occupied by","Leased to","Became neutral or demilitarized zone of","Mandated to","Sovereign","Unincorporated territory","Autonomous constituent country of","Sovereign (unrecognised)","Sovereign (limited)","Protected area of","Unknown","","x","y","concat","Boolean","window","location","hostname","match","ReactDOM","render","react_default","a","createElement","App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","initialState","links","entities","AppContext","createContext","state","dispatch","arg","console","log","groupByCOWCode","groupBy","link","COW_code","SOV","SOV_U","SOV_L","toMap","object","map","MultiMap","key","hasOwnProperty","entity","undefined","index","length","set","reducer","action","type","payload","csvLink","id","uuid","COW_name","end_year","Date","start_year","status","link_type","sovereign","sovereign_COW_code","sovereign_COW_name","entitiesMap","wEntities","mapObjIndexed","ownLinks","selectOccupations","pipe","filter","includes","equals","selectCampains","occ","name","start","min","end","max","occupations","campains","wMapEntities","Object","_Users_arnaudpichon_dev_shing_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","forEach","values","loadedActionCreator","data","dataPromise","csv","AppContextProvider","props","_useReducer","useReducer","_useReducer2","_Users_arnaudpichon_dev_shing_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","useEffect","react__WEBPACK_IMPORTED_MODULE_2___default","Provider","value","children","countriesToOptions","country","label","process","routes","mount","/","route","title","view","navigation","useNavigation","useContext","onChange","useCallback","event","navigate","react_select__WEBPACK_IMPORTED_MODULE_6__","options","/country/:id","_ref","_Users_arnaudpichon_dev_shing_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_arnaudpichon_dev_shing_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","req","wrap","_context","prev","next","abrupt","_Country__WEBPACK_IMPORTED_MODULE_8__","params","stop","_x","apply","this","arguments","createMemoryNavigation","basename","className","_AppContext__WEBPACK_IMPORTED_MODULE_9__","react_navi__WEBPACK_IMPORTED_MODULE_5__","react__WEBPACK_IMPORTED_MODULE_2__","fallback","colorScale","scaleOrdinal","domain","legend","margins","formater","timeFormat","dateReducer","accumulator","sortByDuration","sort","_ref2","aLinks","slicedToArray","reduce","countByStatus","acc","_ref5","toConsumableArray","countBy","Timelines","useMemo","Array","from","associations","minDate","_ref7","maxDate","_ref9","width","elHeight","dimension","lineHeight","height","groupWidth","hideGroupLabels","groupHeight","intervalRectWidth","Math","intervalMinWidth","xScale","scaleTime","range","yScale","scaleLinear","xAxis","axisBottom","intervalBarHeight","intervalBarMargin","_useState","useState","_useState2","hover","setHover","_useState3","_useState4","setStatus","countedByStatus","style","transform","minWidth","number","onClick","cx","legend-item","legend-item--hidden","backgroundColor","patternUnits","stroke","strokeWidth","ref","element","select","call","group","has_status","_ref11","_ref12","x1","x2","y1","y2","strokeOpacity","fontSize","dy","w","rx","onLinkClick","onMouseEnter","fill","isNaN","Country","find","onOccupiedLinkClick","onCampainsLinkClick","es","href","src_timeline"],"mappings":"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","file":"static/js/main.d0076b6b.chunk.js","sourcesContent":["\nexport const xCowName = (link: Link) => link.COW_name;\n// export const xSovereignCowName = (link: Link) => link.sovereign_COW_name;\n// export const xType = (link: Link) => link.link_type === 'Sovereign';\nexport const translate_link_type: any = {\n  \"Became part of\" : {\"slug\":\"part\",\"priority\":2},\n  \"Became colony of\": {\"slug\":\"col\",\"priority\":3},\n  \"Became possession of\": {\"slug\":\"poss\",\"priority\":3},\n  \"Claimed by\": {\"slug\":\"claim\",\"priority\":0},\n  \"Became protectorate of\": {\"slug\":\"prot\",\"priority\":3},\n  \"Became associated state of\": {\"slug\":\"assoc\",\"priority\":0},\n  \"Occupied by\": {\"slug\":\"occ\",\"priority\":1},\n  \"Leased to\": {\"slug\":\"leas\",\"priority\":0},\n  \"Became neutral or demilitarized zone of\": {\"slug\":\"neut\",\"priority\":0},\n  \"Mandated to\": {\"slug\":\"mand\",\"priority\":0},\n  \"Sovereign\": {\"slug\":\"SOV\",\"priority\":4},\n  \"Unincorporated territory\": {\"slug\":\"uninc\",\"priority\":0},\n  \"Autonomous constituent country of\": {\"slug\":\"autonom\",\"priority\":0},\n  \"Sovereign (unrecognised)\": {\"slug\":\"SOV_U\",\"priority\":0},\n  \"Sovereign (limited)\": {\"slug\":\"SOV_L\",\"priority\":1},\n  \"Protected area of\": {\"slug\":\"protected\",\"priority\":0},\n  \"Unknown\": {\"slug\":\"N/A\",\"priority\":0},\n  \"\": {\"slug\": \"alliance\", \"priority\": 0}\n}\n\nexport const translate = (x: number, y: number) => `translate(${x}, ${y})`\n\nexport enum STATUS_SLUG {\n  part = \"part\",\n  col = \"col\",\n  poss = \"poss\",\n  claim = \"claim\",\n  prot = \"prot\",\n  assoc = \"assoc\",\n  occ = \"occ\",\n  leas = \"leas\",\n  neut = \"neut\",\n  mand = \"mand\",\n  SOV = \"SOV\",\n  uninc = \"uninc\",\n  autonom = \"autonom\",\n  SOV_U = \"SOV_U\",\n  SOV_L = \"SOV_L\",\n  protected = \"protected\",\n  NA = \"N/A\",\n  alliance = \"alliance\",\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React, { useEffect } from 'react';\nimport { csv, DSVRowArray, max, min, values } from 'd3';\nimport { useReducer, createContext } from \"react\";\nimport { action, ActionType } from 'typesafe-actions';\nimport uuid from 'uuid';\nimport { translate_link_type, STATUS_SLUG } from './utils';\nimport groupBy from 'ramda/es/groupBy';\nimport map from 'ramda/es/map';\nimport equals from 'ramda/es/equals';\nimport filter from 'ramda/es/filter';\nimport pipe from 'ramda/es/pipe';\nimport mapObjIndexed from 'ramda/es/mapObjIndexed';\nimport { MultiMap } from 'mnemonist';\n\nconst initialState: GlobalState = {\n  links: [],\n  entities: [],\n}\n\ninterface AppContext {\n  state: any;\n  dispatch: (action: any) => any;\n}\n\nexport const AppContext = createContext<AppContext>({\n  state: initialState,\n  dispatch: (arg) => {\n    console.log('not la bonne fonction poto', arg);\n  }\n});\n\nconst groupByCOWCode = groupBy((link: Link) => link.COW_code);\n\nconst SOV = [STATUS_SLUG.SOV, STATUS_SLUG.SOV_U, STATUS_SLUG.SOV_L]\n\nconst toMap = (object: {[key: string]: Link[]}, entities: {[key: string]: Entity}) => {\n  const map = new MultiMap<Entity, Link>();\n  for (const key in object) {\n    if (object.hasOwnProperty(key)) {\n      const links = object[key];\n      const entity = entities[key]\n      if (entity === undefined) {\n        continue\n      }\n      for (let index = 0; index < links.length; index++) {\n        const link = links[index];\n        map.set(entity, link);\n      }\n    }\n  }\n  return map;\n}\n\nconst reducer = (state: GlobalState, action: ActionType<any>) => {\n  switch (action.type) {\n    case 'LOADED': {\n      const links: WLink[] = action.payload.map((csvLink: CSVLink) => {\n        return {\n          id: uuid() as string,\n          COW_code: csvLink.COW_code,\n          COW_name: csvLink.COW_name,\n          end_year: new Date(csvLink.end_year),\n          start_year: new Date(csvLink.start_year),\n          status: translate_link_type[csvLink.link_type],\n          sovereign: {\n            COW_code: csvLink.sovereign_COW_code,\n            COW_name: csvLink.sovereign_COW_name,\n          }\n        } as WLink;\n      });\n      const entitiesMap = groupByCOWCode(links);\n      const wEntities: {[key: string]: Entity} = mapObjIndexed((ownLinks: Link[], COW_code: COW_code) => {\n        const selectOccupations = pipe(\n          filter((link: WLink) => !SOV.includes(link.status.slug) && equals(link.COW_code, COW_code)),\n          // groupByCOWCode,\n          groupBy((link: WLink) => link.sovereign.COW_code),\n        );\n        const selectCampains = pipe(\n          filter((link: WLink) => equals(link.sovereign.COW_code, COW_code)),\n          groupByCOWCode,\n        );\n        const occ = selectOccupations(ownLinks);\n        // console.log(occ);\n        return {\n          id: COW_code,\n          name: entitiesMap[COW_code][0].COW_name,\n          start: min(ownLinks, d => d.start_year),\n          end: max(ownLinks, d => d.end_year),\n          occupations: occ,\n          campains: selectCampains(links)\n        };\n      }, entitiesMap);\n      const wMapEntities = map((entity: WEntity) => ({\n        ...entity,\n        occupations: toMap(entity.occupations, wEntities),\n        campains: toMap(entity.campains, wEntities)\n      }), wEntities);\n      links.forEach((link: WLink) => {\n        link.sovereign = wMapEntities[link.sovereign.COW_code];\n      });\n      return {\n        links: links as unknown as Link[],\n        entities: values(wMapEntities)\n      }\n    }\n  }\n  return state;\n}\n\nconst loadedActionCreator = (data: DSVRowArray<string>) => action('LOADED', data);\n\nconst dataPromise = csv('data/RICentities_links.csv');\nconst AppContextProvider: React.FC = (props: any) => {\n  const [state, dispatch] = useReducer(reducer, initialState as never);\n  useEffect(() => {\n    dataPromise.then(pipe(loadedActionCreator, dispatch));\n  }, []);\n  return (\n    <AppContext.Provider value={{state, dispatch: dispatch}}>\n      {props.children}\n    </AppContext.Provider>\n  )\n}\n\nexport default AppContextProvider;\n","import React, { useCallback, Suspense, useContext } from 'react';\nimport { map } from 'ramda';\nimport { mount, route, createMemoryNavigation } from 'navi';\nimport { Router, View, useNavigation } from 'react-navi';\nimport Select from 'react-select';\n\nimport './App.css';\nimport Country from './Country';\nimport AppContextProvider, { AppContext } from './AppContext';\n// import createMemoryHistory from 'history/createMemoryHistory';\n\nconst countriesToOptions = map((country: Entity) => ({\n  value: country.id, label: country.name,\n}));\n\nconst Home: React.FC = () => {\n  const navigation = useNavigation();\n  const { state }: {state: GlobalState} = useContext(AppContext);\n  const onChange = useCallback((event) => {\n    navigation.navigate(`/country/${event.value}`);\n  }, [navigation]);\n  return (\n    <Select\n      onChange={onChange}\n      options={countriesToOptions(state.entities)}\n    />\n  );\n}\n\nconsole.log(process)\n\nconst routes = mount({\n  '/': route({\n    title: 'Welcome',\n    view: <Home />,\n  }),\n  '/country/:id': route(async req => {\n    return {\n      title: 'Coutry',\n      view: <Country id={req.params.id} />,\n    }\n  })\n});\n\nconst navigation = createMemoryNavigation({\n  routes: routes,\n  basename: '/ric_entities_timelines'\n});\n\n\n\nconst App: React.FC = () => {\n  return (\n    <div className=\"App\">\n      <AppContextProvider>\n        <Router navigation={navigation}>\n          <Suspense fallback={null}>\n            <View />\n          </Suspense>\n        </Router>\n      </AppContextProvider>\n    </div>\n  );\n}\n\nexport default App;\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { scaleTime, scaleOrdinal, min, max, axisBottom, select, scaleLinear, timeFormat } from 'd3';\nimport values from 'ramda/es/values';\nimport sort from 'ramda/es/sort';\nimport reduce from 'ramda/es/reduce';\nimport countBy from 'ramda/es/countBy';\nimport mapObjIndexed from 'ramda/es/mapObjIndexed';\nimport pipe from 'ramda/es/pipe';\nimport MultiMap from 'mnemonist/multi-map';\nimport cx from 'classnames';\nimport { translate, STATUS_SLUG } from './utils';\nimport './timeline.css'\n\nconst colorScale = scaleOrdinal(['#e6194b', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff', '#000000']).domain(values(STATUS_SLUG));\nconst legend = {\n  height: 50,\n}\nconst margins = {\n  top: 0,\n  right: 0,\n  bottom: 50,\n  left: 0\n};\nconst formater = timeFormat('%Y');\n\nconst dateReducer = (accumulator, link: Link) => accumulator + (+link.end_year) - +link.start_year\n\nconst sortByDuration = sort(([, aLinks], [, bLinks]) => bLinks.reduce(dateReducer, 0) - aLinks.reduce(dateReducer, 0));\nconst countByStatus = pipe(\n  reduce((acc, [, links]: [Entity, Link[]]) => [...acc, ...links], []),\n  countBy((link: Link) => link.status.slug),\n);\n\nconst Timelines: React.FC<{\n  data: MultiMap<Entity, Link>;\n  hideGroupLabels?: boolean;\n  intervalMinWidth: number;\n  lineHeight: number;\n  width: number;\n  onLinkClick: (link: Link) => void;\n}> = props => {\n  const data: [Entity, Link[]][] = useMemo(() => sortByDuration(Array.from(props.data.associations() as any)), [props.data]);\n  const minDate = min(data, ([{start}]) => start);\n  const maxDate = max(data, ([{end}]) => end);\n  const width = props.width - margins.left - margins.right;\n  const elHeight = props.data.dimension * props.lineHeight + margins.top + margins.bottom;\n  const height = elHeight - margins.top - margins.bottom;\n  const groupWidth = props.hideGroupLabels ? 0 : 200;\n  const groupHeight = height / data.length;\n  const intervalRectWidth = (d: Link) => Math.max(props.intervalMinWidth, xScale(d.end_year) - xScale(d.start_year))\n  const xScale = scaleTime()\n    .domain([minDate, maxDate])\n    .range([groupWidth, width]);\n  const yScale = scaleLinear()\n    .domain([0, props.data.dimension])\n    .range([0, height]);\n  const xAxis = axisBottom(xScale);\n  const intervalBarHeight = 0.8 * groupHeight;\n  const intervalBarMargin = (groupHeight - intervalBarHeight) / 2;\n  const [hover, setHover] = useState<{link: Link, index: number}>();\n  const [status, setStatus] = useState<STATUS_SLUG>();\n  const countedByStatus = useMemo(() => countByStatus(data), [data]);\n  useEffect(() => () => {setHover(null); setStatus(null)}, [props.data]);\n  return (\n    <div className='timelines-container' style={{width: width}} /* onMouseLeave={() => setHover(null)} */ >\n      {hover && <div className='tooltip-container' style={{\n        transform: `translate(${xScale(hover.link.start_year)}px, ${yScale(hover.index) + legend.height + margins.top + props.lineHeight}px)`,\n        minWidth: intervalRectWidth(hover.link)\n      }}>\n        <span className='tooltip'>{hover.link.COW_name} was a {hover.link.status.slug} from {formater(hover.link.start_year)} to {formater(hover.link.end_year)}</span>\n      </div>}\n      <div className='legend-container'>\n        {values(mapObjIndexed((number, label) => \n          <button onClick={() => status === label ? setStatus(null) : setStatus(label)} className={cx({\n            'legend-item': true,\n            'legend-item--hidden': status && status !== label,\n          })} key={label} style={{backgroundColor: colorScale(label)}}>{label} : {number}</button>\n        , countedByStatus))}\n      </div>\n      <svg height={elHeight} width={props.width}>\n        <g transform={translate(margins.left, margins.top)}>\n          <defs>\n          <pattern id=\"diagonalHatch\" patternUnits=\"userSpaceOnUse\" width=\"4\" height=\"4\">\n            <path d=\"M-1,1 l2,-2\n                    M0,4 l4,-4\n                    M3,5 l2,-2\"\n              style={{stroke: 'black', strokeWidth: 1}} />\n            </pattern>\n            <clipPath id='chart-content'>\n              <rect x={groupWidth} y={0} height={height} width={width - groupWidth} />\n            </clipPath>\n            <clipPath id='name-area'>\n              <rect x={0} y={0} height={height} width={groupWidth} />\n            </clipPath>\n          </defs>\n          <g transform={translate(0, height)} ref={element => {\n            if (element) {\n              select(element).call(xAxis);\n            }\n          }} />\n          <g className={cx({\n            group: true,\n            has_status: !!status\n          }, status)}>\n            {data.map(([entity, links], index) => {\n              return (\n                <g key={entity.name} className={entity.name} transform={translate(0, yScale(index))}>\n                  <line className='group-separator' x1={0} x2={width} y1={0} y2={0} stroke='black' strokeOpacity={0.1} />\n                  <text className='entity-label' fontSize={props.lineHeight} dy='1em'>{entity.name}</text>\n                  <g>\n                    {links.map((link: Link) => {\n                      const w = intervalRectWidth(link);\n                      return (\n                        <g key={link.id} transform={translate(xScale(link.start_year), intervalBarMargin)}>\n                          <rect\n                            rx='5'\n                            className={cx('link-rect', link.status.slug)}\n                            onClick={() => props.onLinkClick(link)}\n                            onMouseEnter={() => setHover({link: link, index: index})}\n                            fill={isNaN(w) ? \"url(#diagonalHatch)\" : colorScale(link.status.slug)}\n                            stroke={hover && hover.link === link ? 'white' : 'black'}\n                            strokeOpacity={hover && hover.link === link ? 1 : 0.2}\n                            strokeWidth={hover && hover.link === link ? 2 : 1}\n                            width={isNaN(w) ? '100%' : w}\n                            height={intervalBarHeight}\n                            y={0}\n                            x={0}\n                          />\n                        </g>\n                      )\n                    })}\n                  </g>\n                </g>\n              )\n            })}\n          </g>\n        </g>\n      </svg>\n    </div>\n  );\n}\n\nexport default Timelines;\n","import React, { useContext, useCallback } from 'react';\n\nimport equals from 'ramda/es/equals';\nimport { Link, useNavigation } from 'react-navi';\nimport { AppContext } from './AppContext';\nimport MultiMap from 'mnemonist/multi-map';\nimport Timelines from './timeline';\n\nconst Country: React.FC<{\n  id: string,\n}> = ({id}) => {\n  const {state}: {state: GlobalState} = useContext(AppContext);\n  const country = state.entities.find(entity => equals(entity.id, id));\n  const navigation = useNavigation();\n  const onOccupiedLinkClick = useCallback(link => {\n    console.log(link);\n    navigation.navigate(`/country/${link.sovereign.id}`)\n  }, [navigation]);\n  const onCampainsLinkClick = useCallback(link => {\n    navigation.navigate(`/country/${link.COW_code}`)\n  }, [navigation]);\n  if (country === undefined) {\n    return (<div>Loading</div>);\n  }\n  return (\n    <div>\n      <aside>\n        <Link href='/'>Home</Link>\n      </aside>\n      <h1>{country.name}</h1>\n      <h2>Territory masters</h2>\n      <Timelines\n        onLinkClick={onOccupiedLinkClick}\n        intervalMinWidth={5}\n        data={country.occupations as MultiMap<Entity, Link>}\n        lineHeight={20}\n        width={1000}\n      />\n      {/* <Histogram width={1000} height={300} data={Array.from(country.campains.values())} /> */}\n      <h2>Occupying territories</h2>\n      <Timelines\n        onLinkClick={onCampainsLinkClick}\n        intervalMinWidth={5}\n        data={country.campains as MultiMap<Entity, Link>}\n        lineHeight={20}\n        width={1000}\n      />\n    </div>\n  );\n}\n\nexport default Country;\n"],"sourceRoot":""}