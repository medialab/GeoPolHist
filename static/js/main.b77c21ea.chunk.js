(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){},111:function(e,t,a){},118:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),i=a.n(c),o=(a(78),a(23)),l=a(69),s=a(26),u=a(24),m=a(38),d=a(17),f=a(71),b=a(70),h=(a(79),a(19)),p=a(7),y=a(37),E=a(33),g=a(35),O=a(6),j=a(63),v=a(34),_=a.n(v),k=a(41),w=a(72),P=a(50),H=a(42),G=a(65),N=a(64),x={links:[],entities:[],status:{}},S=Object(n.createContext)({state:x,dispatch:function(e){console.log("not la bonne fonction poto",e)}}),C=Object(k.a)(function(e){return e.GPH_code}),M=function(e,t){var a=new N.MultiMap;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],c=t[n];if(void 0===c)continue;for(var i=0;i<r.length;i++){var o=r[i];a.set(c,o)}}return a},D=function(e,t){switch(t.type){case"LOADED":var a=t.payload[0],n=t.payload[1],r=a.map(function(e){var t={id:_()(),GPH_code:e.GPH_code,GPH_name:e.GPH_name,end_year:new Date(e.end_year),start_year:new Date(e.start_year),status:n[e.GPH_status],sovereign:{GPH_code:e.sovereign_GPH_code,GPH_name:e.sovereign_GPH_name}};return t.status||console.error("unknown link type",e),t}),c=C(r),i=Object(G.a)(function(e,t){var a=Object(H.a)(Object(P.a)(function(e){return Object(E.a)(e.GPH_code,t)}),Object(k.a)(function(e){return e.sovereign.GPH_code||t})),n=Object(H.a)(Object(P.a)(function(e){return Object(E.a)(e.sovereign.GPH_code,t)}),C),i=a(e),o=n(r),l=Object(k.a)(function(e){return e.status.slug},Object(w.a)(Object(O.k)(o)));return{id:t,name:c[t][0].GPH_name,start:Object(O.e)(e,function(e){return e.start_year}),end:Object(O.d)(e,function(e){return e.end_year}),occupations:i,campains:o,campainsMap:l}},c),o=Object(l.a)(function(e){return Object(h.a)({},e,{occupations:M(e.occupations,i),campains:M(e.campains,i)})},i);return r.forEach(function(e){e.sovereign=o[e.sovereign.GPH_code]}),{links:r,entities:Object(O.k)(o),status:n}}return e},L=function(e){return Object(j.action)("LOADED",e)},W=Object(O.c)("./data/GeoPolHist_entities_status_in_time.csv"),B=fetch("./data/GPH_status.json").then(function(e){return e.json()}),A=Promise.all([W,B]),z=function(e){var t=Object(n.useReducer)(D,x),a=Object(p.a)(t,2),c=a[0],i=a[1];return Object(n.useEffect)(function(){A.then(Object(H.a)(L,i))},[]),r.a.createElement(S.Provider,{value:{state:c,dispatch:i}},e.children)},I=a(66),R=a(40),J=a.n(R),U=function(e,t){return"translate(".concat(e,", ").concat(t,")")},V=(a(110),0),F=0,T=50,Y=0,$=Object(O.j)("%Y"),q=function(e){var t=e.xScale,a=e.data,c=e.nbLines,i=e.colorScale,l=Object(n.useMemo)(_.a,[]),s=e.width-Y-F,u=c*e.lineHeight+V+T,m=u-V-T,d=e.hideGroupLabels?0:200,f=m/a.length;t.range([d,s-15]);var b=Object(O.f)().domain([0,c]).range([0,m]),h=Object(O.b)(t),E=Object(O.a)(t),g=.8*f,j=(f-g)/2,v=Object(n.useState)(),k=Object(p.a)(v,2),w=k[0],P=k[1],H=Object(n.useState)(),G=Object(p.a)(H,2),N=G[0],x=G[1],S=Object(y.a)(function(e){return e.priority+e.GPH_status})(Object(I.a)(a.reduce(function(e,t){var a=Object(p.a)(t,2)[1];return[].concat(Object(o.a)(e),Object(o.a)(a))},[]).reduce(function(e,t){return e[t.status.slug]=t.status,e},{}))).reverse();return Object(n.useEffect)(function(){return function(){P(null),x(null)}},[e.data]),r.a.createElement("div",{className:"timelines-container",style:{width:s},onMouseLeave:function(){return P(null)}},r.a.createElement("div",{className:"legend"},r.a.createElement("div",{className:"legend-container"},S.map(function(e){return r.a.createElement("span",{key:e.slug,onClick:function(){N===e.slug?x(null):x(e.slug)},className:J()({"legend-item":!0,"legend-item--hidden":N&&N!==e.slug})},r.a.createElement("div",{className:"colorLegendItem",style:{backgroundColor:i(e.slug)}}),r.a.createElement("span",null,e.GPH_status))})),r.a.createElement("svg",{height:20,width:e.width},r.a.createElement("g",{transform:U(Y,V)},r.a.createElement("g",{transform:U(0,17),ref:function(e){e&&Object(O.i)(e).call(h)}})))),r.a.createElement("div",{className:"timeline"},r.a.createElement("svg",{height:u,width:e.width},r.a.createElement("g",{transform:U(Y,V)},r.a.createElement("defs",null,r.a.createElement("pattern",{id:"diagonalHatch-".concat(l),patternUnits:"userSpaceOnUse",width:"4",height:"4"},r.a.createElement("path",{d:"M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2",style:{stroke:"black",strokeWidth:1}})),r.a.createElement("clipPath",{id:"name-area-".concat(l)},r.a.createElement("rect",{x:0,y:0,height:m,width:d}))),r.a.createElement("g",{transform:U(0,m),ref:function(e){e&&Object(O.i)(e).call(E)}}),r.a.createElement("g",{className:J()({group:!0,has_status:!!N},N)},a.map(function(a,n){var c=Object(p.a)(a,2),o=c[0],u=c[1];return r.a.createElement("g",{key:o.name,className:o.name,transform:U(0,b(n))},r.a.createElement("line",{className:"group-separator",x1:0,x2:s,y1:0,y2:0,stroke:"black",strokeOpacity:.1}),r.a.createElement("text",{className:"entity-label",style:{clipPath:"url(#name-area-".concat(l,")"),cursor:"pointer"},fontSize:"1em",dy:"1em",width:d,onClick:function(){return e.onEntityClick(o.id)}},o.name.length<=22?o.name:o.name.slice(0,22)+"\u2026",r.a.createElement("title",null,o.name)),r.a.createElement("g",null,u.map(function(a){var c,s=(c=a,Math.max(e.intervalMinWidth,t(c.end_year)-t(c.start_year)));return r.a.createElement("g",{key:a.id,transform:U(t(a.start_year),j)},r.a.createElement("rect",{rx:"5",className:J()("link-rect",a.status.slug),onClick:function(){return e.onEntityClick(o.id)},onMouseEnter:function(){return P({link:a,index:n})},fill:isNaN(s)?"url(#diagonalHatch-".concat(l,")"):i(a.status.slug),stroke:w&&w.link===a?"white":"black",strokeOpacity:w&&w.link===a?1:.2,strokeWidth:w&&w.link===a?2:1,width:isNaN(s)?"100%":s,height:g,y:0,x:0}))})))})))),w&&r.a.createElement("div",{className:"tooltip-container",style:{transform:"translate(".concat(t(w.link.start_year),"px, ").concat(b(w.index)-e.lineHeight,"px)")}},r.a.createElement("span",{className:"tooltip"},w.link.GPH_name," - ",w.link.status.GPH_status," - ",$(w.link.start_year)," to ",$(w.link.end_year)))))},K=(a(111),Object(d.a)(function(e,t){return e>t})),Q=Object(g.a)(function(e,t){return+t.end_year-+t.start_year+e},0),X={duration:Object(d.a)(function(e,t){var a=Object(p.a)(e,2)[1],n=Object(p.a)(t,2)[1];return Q(n)-Q(a)}),year:Object(d.a)(function(e,t){var a=Object(p.a)(e,2)[1],n=Object(p.a)(t,2)[1];return+K(a.map(function(e){return e.start_year}))[0]-+K(n.map(function(e){return e.start_year}))[0]}),name:Object(y.a)(function(e){return Object(p.a)(e,1)[0].name})},Z=Object(d.a)(function(e,t){return e.start_year>t.start_year}),ee=function(e){return e.map(function(e){return[e[0],Z(e[1]).reduce(function(e,t){if(e&&0!==e.length){var a=e[e.length-1];if(a.end_year>t.start_year)if(a.status.priority>=t.status.priority){var n=a.end_year;+n===+a.end_year&&+t.end_year===+a.end_year||+n>+t.end_year?console.warn("one overlapping status removed",t):e.push(Object(h.a)({},t,{start_year:n}))}else a.end_year=t.start_year,e.push(Object(h.a)({},t));else e.push(Object(h.a)({},t));return e}return[Object(h.a)({},t)]},[])]})},te=function(e){var t=e.history,a=e.country,c=Object(n.useCallback)(function(e){t.push("/country/".concat(e))},[t]),i=ee(Array.from(a.occupations.associations())),l=ee(Array.from(a.campains.associations())),u=Object(n.useMemo)(function(){return[].concat(Object(o.a)(i),Object(o.a)(l))},[i,l]),d=Object(O.e)(u,function(e){return Object(p.a)(e,1)[0].start}),f=Object(O.d)(u,function(e){return Object(p.a)(e,1)[0].end}),b=Object(O.h)().domain([d,f]),y=Object(n.useContext)(S).state,E=Object(O.g)(["#cd7f3d","#af49d8","#65da57","#d84397","#cbe240","#6c6cd4","#a3ca63","#ad63ab","#489046","#d74433","#6cdaaf","#c15b67","#86c5d8","#d8b94f","#6779a8","#787938","#d4a8cc","#4f8178","#cdcea7","#997462"]).domain(Object.keys(y.status).map(function(e){return y.status[e].slug})),g=Object(n.useState)(),j=Object(p.a)(g,2),v=j[0],_=j[1],k=X[v||"year"](l);return r.a.createElement("div",null,r.a.createElement("aside",null,r.a.createElement(s.b,{to:"/"},"GeoPolHist")),r.a.createElement("h1",null,a.name),r.a.createElement("p",null,"GPH_code : ",a.id),r.a.createElement("h2",null,"Status"),r.a.createElement(q,{onEntityClick:c,intervalMinWidth:5,data:i,nbLines:a.occupations.dimension,lineHeight:20,width:1e3,xScale:b,colorScale:E}),r.a.createElement("div",{style:{width:"1000px",margin:"0 auto"}},r.a.createElement("h2",null,"Sovereign of ",a.campains.dimension," entities"),r.a.createElement("span",null,"sort by ",r.a.createElement(m.a,{className:"inlineSelect",onChange:function(e){return _(e.value)},defaultValue:{value:"year",label:"first date"},theme:function(e){return Object(h.a)({},e,{borderRadius:5,colors:Object(h.a)({},e.colors,{primary25:"lightgrey",primary:"grey",background:"white",color:"black"})})},isSearchable:!1,options:[{value:"year",label:"first date"},{value:"duration",label:"duration"},{value:"name",label:"entity name"}]}))),r.a.createElement(q,{onEntityClick:c,intervalMinWidth:5,data:k,nbLines:a.campains.dimension,lineHeight:20,width:1e3,xScale:b,colorScale:E}))},ae=function(e){var t=e.match.params.id,a=Object(n.useContext)(S).state.entities.find(function(e){return Object(E.a)(e.id,t)});return void 0===a?r.a.createElement("div",null,"Loading"):r.a.createElement(te,Object.assign({},e,{country:a}))},ne=Object(l.a)(function(e){return{value:e.id,label:e.name}}),re=Object(d.a)(function(e,t){return t.occupations.size-e.occupations.size}),ce=Object(b.a)(0,["campainsMap","col","length"]),ie=Object(d.a)(function(e,t){return ce(t)-ce(e)}),oe=Object(f.a)(5),le=function(e){var t=oe(re(e.entities)),a=oe(ie(e.entities)),n=oe(function(e){var t=Object(d.a)(function(e,t){return t.end_year>e.end_year});return Object(d.a)(function(e,t){return t.end>e.end})(e.filter(function(e){return"dis"===t(Object(o.a)(e.occupations.values()))[0].status.slug}))}(e.entities)),c=new Intl.DateTimeFormat("en-GB",{year:"numeric"});return r.a.createElement("div",null,r.a.createElement("div",{className:"line"},r.a.createElement("div",{className:"grow"},r.a.createElement("h3",null,"Biggest number of sovereigns"),r.a.createElement("ol",null,t.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/country/".concat(e.id)},e.name," - ",e.occupations.size," sovereigns"))}))),r.a.createElement("div",{className:"grow"},r.a.createElement("h3",null,"Biggest number of colonies"),r.a.createElement("ol",null,a.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/country/".concat(e.id)},e.name," - ",ce(e)," colonies"))}))),r.a.createElement("div",{className:"grow"},r.a.createElement("h3",null,"Most recently disolved"),r.a.createElement("ol",null,n.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/country/".concat(e.id)},e.name," - ",c.format(e.end)))})))))},se=function(e){var t=Object(n.useContext)(S).state,a=Object(n.useCallback)(function(t){e.history.push("/country/".concat(t.value))},[e.history]);return r.a.createElement("div",{className:"container container--home"},r.a.createElement("h1",null,"GeoPolHist",r.a.createElement("br",null),"Geo-Political entities History from 1816 to 2020"),r.a.createElement("p",null,"Paragraph about the data set."),r.a.createElement("h2",null,"Visualise a Geo-Political entities political history"),r.a.createElement(m.a,{placeholder:t.entities.length?"Search for a Geo-Political entity":"Still loading",onChange:a,options:ne(t.entities)}),t.entities.length?r.a.createElement(le,{entities:t.entities}):r.a.createElement("p",null,"Data is still loading..."),r.a.createElement("h2",null,"References"),r.a.createElement("p",null,"See our data paper for more information about how and why we built this data set:"),r.a.createElement("p",null,'Dedinger B\xe9atrice, Girard Paul, "GeoPolHist, a new data set of the geo-political entities of the world (1816-2020)" 2020 (in review)'),r.a.createElement("p",null,"Download the data set from ",r.a.createElement("a",{href:"https://github.com/medialab/GeoPolHist"},"GeoPolHist datapackage repository")),r.a.createElement("iframe",{title:"GPH status evolutions in 1816,1885,1950 and 2020",src:"./sankey.html"}),r.a.createElement("p",null,r.a.createElement("a",{href:"./sankey.html"},"open the diagram in full page")))},ue=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(z,null,r.a.createElement(s.a,{basename:"/GeoPolHist"},r.a.createElement(u.a,{path:"/",exact:!0,component:se}),r.a.createElement(u.a,{path:"/country/:id",component:ae}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},73:function(e,t,a){e.exports=a(118)},78:function(e,t,a){},79:function(e,t,a){}},[[73,1,2]]]);
//# sourceMappingURL=main.b77c21ea.chunk.js.map